society_decisions = { #only available to members of a society
	request_to_rank_up_within_stormchaser_society = { #this is the new rank up decision if you want one, you do not need this if you use de default one

		hide_in_decisions_list = yes # This is shown in the Society View
		
		potential = {
			hidden_tooltip = {
				society_rank <= 3 #is not max rank
				days_in_society > 365 #days requirement
				is_in_society = yes #obviously
				OR = { #Players can always rank up (if they have the power), AI won't if there is no room
					ai = no
					AND = {
						ai = yes
						society_can_rank_up = yes
					}
				}
			}
		}

		allow = {
			#Rank requirements. IMPORTANT!!! If you change the requirements, the customizable loc keys "GetSocietyRankUpTooltip" 1, 2, 3, and 4 must be updated, as it displays these requirements.
			custom_tooltip = { # Sufficient currency
				text = request_to_rank_up_within_stormchaser_society_tt
				OR = {
					AND = {
						society_rank == 1
						society_currency >= 750
					}
					AND = {
						society_rank == 2
						society_currency >= 1000
					}
					AND = {
						society_rank == 3
						society_currency >= 2000
					}
				}
			}

			custom_tooltip = {
				text = must_not_have_sent_request_already_tooltip 
				NOT = { has_character_flag = has_sent_request_to_rank_up }
			}

			custom_tooltip = {
				text = must_be_allowed_to_rank_up_tooltip 
				days_at_current_society_rank >= 1095 #IMPORTANT! Update tooltip.
			}

			custom_tooltip = {
				text = must_have_grandmaster_tooltip #You must have a grand master
				any_society_member = {
					is_society_grandmaster = yes
					same_society_as = ROOT
				}
			}
		}

		effect = {
			#Rank up cost
			if = {
				limit = { society_rank == 1 }
				change_society_currency = -750
			}
			if = {
				limit = { society_rank == 2 }
				change_society_currency = -1000
			}
			if = {
				limit = { society_rank == 3 }
				change_society_currency = -2000
			}

			#Perform rank up
			hidden_tooltip = {
				save_event_target_as = rank_up_target #mark the character as the one ranking up
				set_character_flag = has_sent_request_to_rank_up
				character_event = { id = TUTOSOCI.120 days = 20 random = 10 } # sends hidden delayed event to self, which then sends request to Leader of the society
				
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	#Decision "power" for rank 1
	stormchaser_society_power_1 = {
		is_high_prio = yes
		ai_check_interval = 60

		potential = { 
			society_member_of = stormchaser_society
			society_rank = 2
			trigger_if = {
				limit =
				{ has_character_flag = traded_stormdata }
					had_character_flag = { flag = traded_stormdata 
					years >= 2
					}
			}
		}

		allow = { #requirement to press it
			society_currency >= 500 #
		}

		effect = {
			change_society_currency = -500
			wealth = 250 
			set_character_flag = traded_stormdata

			
			if = {
				limit = {
					has_quest = quest_stormchaser_quest_1
				}
				character_event = { id = TUTOSOCI.142 }
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}

	stormchaser_society_power_2 = {
		is_high_prio = yes
		ai_check_interval = 60

		potential = { 
			society_member_of = stormchaser_society
			society_rank = 2
			trigger_if = {
				limit =
				{ has_character_flag = traded_stormdata }
					had_character_flag = { flag = traded_stormdata 
					years >= 2
					}
			}
		}

		allow = { 
			society_currency >= 500 
		}

		effect = {
			change_society_currency = -500
			prestige = 250 
			set_character_flag = traded_stormdata

			
			if = {
				limit = {
					has_quest = quest_stormchaser_quest_1
				}
				character_event = { id = TUTOSOCI.142 }
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
}

targetted_decisions = {
	stormchaser_society_become_meteorologist = {
		ai_check_interval = 12
		is_high_prio = yes
		only_playable = yes
		filter = self
		ai_target_filter = self

		from_potential = {
			society_member_of = stormchaser_society
			society_rank >= 3
		}

		potential = {
			society_member_of = stormchaser_society
			society_rank >= 3
		}

		allow = {
			FROM = {
			society_member_of = stormchaser_society
			NOT = { trait = meteorologist }
			society_currency >= 500
			}
		}
		effect = {
			FROM = {
				add_trait = meteorologist
				change_society_currency = -500
			}

		}
		ai_will_do = {
			factor = 1
		}
	}
	stormchaser_society_become_stormchaser = {
		ai_check_interval = 12
		is_high_prio = yes
		only_playable = yes
		filter = self
		ai_target_filter = self

		from_potential = {
			society_member_of = stormchaser_society
			society_rank = 4
		}

		potential = {
			society_member_of = stormchaser_society
			society_rank = 4
		}

		allow = {
			FROM = {
			society_member_of = stormchaser_society
			NOT = { trait = stormchaser_trait }
			society_currency >= 750
			}
		}
		effect = {
			FROM = {
				add_trait = stormchaser_trait
				change_society_currency = -750
			}

		}
		ai_will_do = {
			factor = 1
		}
	}
	stormchaser_society_inspire = {
		ai_check_interval = 12
		potential = {
			NOT = { is_incapable = yes }
			OR = {
				same_realm = FROM
				same_society_as = FROM
			}
			is_within_diplo_range = FROM
		}

		from_potential = {
			society_member_of = stormchaser_society
			society_rank >= 3
			is_adult = yes
			NOT = { is_incapable = yes }			
		}
		allow = {
			FROM = {
				society_currency >= 500
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
			in_command = no
			same_realm = FROM
			OR = {
				is_landed = yes
				is_patrician = yes
				is_close_relative = FROM
			}
			NOT = {
				has_opinion_modifier = {	###opinion modifier 10yrs cooldown
					who = FROM
					modifier = opinion_teach_virtue
				}
			}
			OR = {
				AND = {
					NOT = { trait = brave }
					FROM = { trait = brave }
				}
				AND = {
					NOT = { trait = diligent }
					FROM = { trait = diligent }
					}
				AND = {
					NOT = { trait = ambitious }
					FROM = { trait = ambitious }
				}
			}
		}
	
		effect = {
			FROM = { change_society_currency = -500 }
			random_list = {
				33 = {
					modifier = {
						factor = 0
						OR = {
							trait = diligent
							FROM = { NOT = { trait = diligent } }
						}
					}
					set_character_flag = storchaser_inspire_diligent
					add_trait = diligent
				}
				33 = {
					modifier = {
						factor = 0
						OR = {
							trait = brave
							FROM = { NOT = { trait = brave } }
						}
					}
					set_character_flag = storchaser_inspire_brave
					add_trait = brave
				}
				33 = {
					modifier = {
						factor = 0
						OR = {
							trait = ambitious
							FROM = { NOT = { trait = ambitious } }
						}
					}
					set_character_flag = storchaser_inspire_ambitious
					add_trait = ambitious
				}
			}
			
			opinion = {										###opinion mostly serves as a 10 years cooldown ; +10 Opinion
				who = FROM
				modifier = opinion_teach_virtue
				months = 120
			}
			FROM = { character_event = { id = MNM.4960 } }
			character_event = { id = MNM.4961 }	
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0
				NOT = {
					AND = {
						is_close_relative = FROM						###AI will only target landed relatives in the same realm
						same_realm = FROM
						OR = {
							is_landed = yes
							is_patrician = yes
						}
					}
				}
			}
		}
	}	
}	

